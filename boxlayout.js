/***boxlayout.jsv1.0.0*http://www.codrops.com**LicensedundertheMITlicense.*http://www.opensource.org/licenses/mit-license.php**Copyright2013,Codrops*http://www.codrops.com*/varBoxlayout=(function(){var$el=$('#bl-main'),$sections=$el.children('section:not(.topleft)'),//workssection$sectionWork=$('#bl-work-section'),//workitems$workItems=$('#bl-work-items>div'),//workpanels$workPanelsContainer=$('#bl-panel-work-items'),$workPanels=$workPanelsContainer.children('div'),totalWorkPanels=$workPanels.length,//navigatingtheworkpanels$nextWorkItem=$workPanelsContainer.find('nav>span.bl-next-work'),$previousWorkItem=$workPanelsContainer.find('nav>span.bl-previous-work'),//ifcurrentlynavigatingtheworkitemsisAnimating=false,//closeworkpaneltrigger$closeWorkItem=$workPanelsContainer.find('nav>.bl-icon-close'),transEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd','msTransition':'MSTransitionEnd','transition':'transitionend'},//transitionendeventnametransEndEventName=transEndEventNames[Modernizr.prefixed('transition')],//supportcsstransitionssupportTransitions=Modernizr.csstransitions;functioninit(){initEvents();}functioninitEvents(){$sections.each(function(){var$section=$(this);//expandtheclickedsectionandscaledowntheothers$section.on('click',function(){if(!$section.data('open')){$section.data('open',true).addClass('bl-expandbl-expand-top');$el.addClass('bl-expand-item');}}).find('.bl-icon-close').on('click',function(){//closetheexpandedsectionandscaleuptheothers$section.data('open',false).removeClass('bl-expand').on(transEndEventName,function(event){if(!$(event.target).is('section'))returnfalse;$(this).off(transEndEventName).removeClass('bl-expand-top');});if(!supportTransitions){$section.removeClass('bl-expand-top');}$el.removeClass('bl-expand-item');returnfalse;});$(document).keyup(function(e){if(!$("#bl-work-section").hasClass("bl-scale-down")){if(e.keyCode==27){$section.data('open',false).removeClass('bl-expand').on(transEndEventName,function(event){if(!$(event.target).is('section'))returnfalse;$(this).off(transEndEventName).removeClass('bl-expand-top');});if(!supportTransitions){$section.removeClass('bl-expand-top');}$el.removeClass('bl-expand-item');returnfalse;}}});});//clickingonaworkitem:thecurrentsectionscalesdownandtherespectiveworkpanelslidesup$workItems.on('click',function(event){//scaledownmainsection$sectionWork.addClass('bl-scale-down');//showpanelforthisworkitem$workPanelsContainer.addClass('bl-panel-items-show');var$panel=$workPanelsContainer.find("[data-panel='"+$(this).data('panel')+"']");currentWorkPanel=$panel.index();$panel.addClass('bl-show-work');returnfalse;});//navigatingtheworkitems:currentworkpanelscalesdownandthenextworkpanelslidesup$nextWorkItem.on('click',function(event){if(isAnimating){returnfalse;}isAnimating=true;var$currentPanel=$workPanels.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<totalWorkPanels-1?currentWorkPanel+1:0;var$nextPanel=$workPanels.eq(currentWorkPanel);$currentPanel.removeClass('bl-show-work').addClass('bl-hide-current-work').on(transEndEventName,function(event){if(!$(event.target).is('div'))returnfalse;$(this).off(transEndEventName).removeClass('bl-hide-current-work');isAnimating=false;});if(!supportTransitions){$currentPanel.removeClass('bl-hide-current-work');isAnimating=false;}$nextPanel.addClass('bl-show-work');if(video.paused!==true&&video.ended!==true){video.pause();}$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');returnfalse;});$(document).keyup(function(e){if($("#bl-work-section").hasClass("bl-scale-down")){if(e.keyCode==39){if(isAnimating){returnfalse;}isAnimating=true;var$currentPanel=$workPanels.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<totalWorkPanels-1?currentWorkPanel+1:0;var$nextPanel=$workPanels.eq(currentWorkPanel);$currentPanel.removeClass('bl-show-work').addClass('bl-hide-current-work').on(transEndEventName,function(event){if(!$(event.target).is('div'))returnfalse;$(this).off(transEndEventName).removeClass('bl-hide-current-work');isAnimating=false;});if(!supportTransitions){$currentPanel.removeClass('bl-hide-current-work');isAnimating=false;}$nextPanel.addClass('bl-show-work');if(video.paused!==true&&video.ended!==true){video.pause();}$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');returnfalse;}if(e.keyCode==37){if(isAnimating){returnfalse;}isAnimating=true;var$currentPanel=$workPanels.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<totalWorkPanels-1?currentWorkPanel-1:0;var$nextPanel=$workPanels.eq(currentWorkPanel);$currentPanel.removeClass('bl-show-work').addClass('bl-hide-current-work').on(transEndEventName,function(event){if(!$(event.target).is('div'))returnfalse;$(this).off(transEndEventName).removeClass('bl-hide-current-work');isAnimating=false;});if(!supportTransitions){$currentPanel.removeClass('bl-hide-current-work');isAnimating=false;}$nextPanel.addClass('bl-show-work');if(video.paused!==true&&video.ended!==true){video.pause();}$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');returnfalse;}if(e.keyCode==27){if($(".bl-expand").hasClass("bl-expand-top")){$sectionWork.removeClass('bl-scale-down');$workPanelsContainer.removeClass('bl-panel-items-show');$workPanels.eq(currentWorkPanel).removeClass('bl-show-work');if(video.paused!==true&&video.ended!==true){video.pause();}$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');returnfalse;}}}});//navigatingtheworkitems:currentworkpanelscalesdownandthepreviousworkpanelslidesup$previousWorkItem.on('click',function(event){if(isAnimating){returnfalse;}isAnimating=true;var$currentPanel=$workPanels.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<totalWorkPanels-1?currentWorkPanel-1:0;var$nextPanel=$workPanels.eq(currentWorkPanel);$currentPanel.removeClass('bl-show-work').addClass('bl-hide-current-work').on(transEndEventName,function(event){if(!$(event.target).is('div'))returnfalse;$(this).off(transEndEventName).removeClass('bl-hide-current-work');isAnimating=false;});if(!supportTransitions){$currentPanel.removeClass('bl-hide-current-work');isAnimating=false;}$nextPanel.addClass('bl-show-work');$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');if(video.paused!==true&&video.ended!==true){video.pause();}returnfalse;});//clickingtheworkpanelsclosebutton:thecurrentworkpanelslidesdownandthesectionscalesupagain$closeWorkItem.on('click',function(event){//scaleupmainsection$sectionWork.removeClass('bl-scale-down');$workPanelsContainer.removeClass('bl-panel-items-show');$workPanels.eq(currentWorkPanel).removeClass('bl-show-work');if(video.paused!==true&&video.ended!==true){video.pause();}$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"'+'pauseVideo'+'","args":""}','*');returnfalse;});}return{init:init};})();